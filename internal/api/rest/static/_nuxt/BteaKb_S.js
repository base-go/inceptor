import{_ as N}from"./BAT_9lwm.js";import{_ as S}from"./BibONXFg.js";import{_ as j}from"./11PQt58c.js";import{u as P,_ as q,a as z}from"./DhQdksfa.js";import{_ as D}from"./Dvcp86dS.js";import{_ as L,a as M}from"./C29POXRi.js";import{_ as T}from"./C31K3EN0.js";import{e as W,g as G,c as d,b as t,w as a,k as Y,h as l,m as _,o as r,a as s,F as H,r as J,t as v,d as b,i as A,l as U}from"./C2I5neRf.js";import"./DlAUqK2U.js";import"./DqghtnId.js";import"./CpvovYk5.js";const O={class:"space-y-6 max-w-4xl"},Q={class:"flex items-center justify-between"},X={key:0,class:"flex items-center justify-center py-8"},Z={key:1,class:"space-y-3"},ee={class:"flex items-center gap-4"},oe={class:"p-2 rounded-lg bg-gray-700"},te={class:"flex items-center gap-2"},le={class:"font-medium capitalize"},ne={class:"text-sm text-gray-400 mt-1"},ae={key:0},se={key:1},ie={key:2},re={key:2,class:"text-center py-8 text-gray-500"},de={class:"space-y-4"},ue={class:"space-y-2"},pe={class:"flex justify-end gap-2"},Ae=W({__name:"settings",setup(me){const p=P(),k=_([]),f=_(!0),m=_(!1),n=_({app_id:"",type:"webhook",config:{url:"",conditions:{on_new_group:!0}},enabled:!0}),c=_([]),C=[{label:"Webhook",value:"webhook",icon:"i-heroicons-globe-alt"},{label:"Email",value:"email",icon:"i-heroicons-envelope"},{label:"Slack",value:"slack",icon:"i-simple-icons-slack"}],h=async()=>{if(!p.apiKey.value){f.value=!1;return}try{f.value=!0;const[i,e]=await Promise.all([p.getAlerts(),p.getApps()]);k.value=i.data||[],c.value=e.data||[],c.value.length&&!n.value.app_id&&(n.value.app_id=c.value[0].id)}catch(i){console.error("Failed to load data:",i)}finally{f.value=!1}};G(h);const F=async()=>{try{await p.createAlert(n.value),m.value=!1,n.value={app_id:c.value[0]?.id||"",type:"webhook",config:{url:"",conditions:{on_new_group:!0}},enabled:!0},h()}catch(i){console.error("Failed to create alert:",i)}},I=async i=>{if(confirm("Are you sure you want to delete this alert?"))try{await p.deleteAlert(i),h()}catch(e){console.error("Failed to delete alert:",e)}},R=i=>C.find(e=>e.value===i)?.icon||"i-heroicons-bell",$=i=>{const e=i.target;p.setApiKey(e.value)};return(i,e)=>{const y=N,u=S,x=j,g=z,V=q,E=D,B=L,w=M,K=T;return r(),d("div",O,[t(x,null,{header:a(()=>[...e[11]||(e[11]=[s("h3",{class:"text-lg font-semibold"},"API Configuration",-1)])]),default:a(()=>[t(u,{label:"Admin API Key",hint:"Your admin key for dashboard access"},{default:a(()=>[t(y,{"model-value":l(p).apiKey.value,type:"password",placeholder:"Enter your admin API key",onChange:$},null,8,["model-value"])]),_:1})]),_:1}),t(x,null,{header:a(()=>[s("div",Q,[e[13]||(e[13]=s("h3",{class:"text-lg font-semibold"},"Alert Rules",-1)),t(g,{icon:"i-heroicons-plus",size:"sm",onClick:e[0]||(e[0]=o=>m.value=!0)},{default:a(()=>[...e[12]||(e[12]=[b(" Add Alert ",-1)])]),_:1})])]),default:a(()=>[l(f)?(r(),d("div",X,[t(V,{name:"i-heroicons-arrow-path",class:"w-6 h-6 animate-spin text-primary-500"})])):l(k).length?(r(),d("div",Z,[(r(!0),d(H,null,J(l(k),o=>(r(),d("div",{key:o.id,class:"flex items-center justify-between p-4 rounded-lg bg-gray-800/50"},[s("div",ee,[s("div",oe,[t(V,{name:R(o.type),class:"w-5 h-5"},null,8,["name"])]),s("div",null,[s("div",te,[s("span",le,v(o.type),1),t(E,{color:o.enabled?"green":"gray",size:"xs"},{default:a(()=>[b(v(o.enabled?"Active":"Disabled"),1)]),_:2},1032,["color"])]),s("div",ne,[o.type==="webhook"?(r(),d("span",ae,v(o.config.url),1)):o.type==="email"?(r(),d("span",se,v(o.config.to),1)):(r(),d("span",ie,"Configured"))])])]),t(g,{icon:"i-heroicons-trash",color:"red",variant:"ghost",onClick:ce=>I(o.id)},null,8,["onClick"])]))),128))])):(r(),d("div",re,[t(V,{name:"i-heroicons-bell-slash",class:"w-12 h-12 mx-auto mb-4"}),e[14]||(e[14]=s("p",null,"No alerts configured",-1)),e[15]||(e[15]=s("p",{class:"text-sm mt-1"},"Create an alert to get notified of crashes",-1))]))]),_:1}),t(K,{modelValue:l(m),"onUpdate:modelValue":e[10]||(e[10]=o=>Y(m)?m.value=o:null)},{default:a(()=>[t(x,null,{header:a(()=>[...e[16]||(e[16]=[s("h3",{class:"text-lg font-semibold"},"Create Alert",-1)])]),footer:a(()=>[s("div",pe,[t(g,{variant:"ghost",onClick:e[9]||(e[9]=o=>m.value=!1)},{default:a(()=>[...e[17]||(e[17]=[b("Cancel",-1)])]),_:1}),t(g,{onClick:F},{default:a(()=>[...e[18]||(e[18]=[b("Create",-1)])]),_:1})])]),default:a(()=>[s("div",de,[t(u,{label:"App"},{default:a(()=>[t(B,{modelValue:l(n).app_id,"onUpdate:modelValue":e[1]||(e[1]=o=>l(n).app_id=o),options:l(c),"option-attribute":"name","value-attribute":"id",placeholder:"Select an app"},null,8,["modelValue","options"])]),_:1}),t(u,{label:"Alert Type"},{default:a(()=>[t(B,{modelValue:l(n).type,"onUpdate:modelValue":e[2]||(e[2]=o=>l(n).type=o),options:C,"option-attribute":"label","value-attribute":"value"},null,8,["modelValue"])]),_:1}),l(n).type==="webhook"?(r(),A(u,{key:0,label:"Webhook URL",required:""},{default:a(()=>[t(y,{modelValue:l(n).config.url,"onUpdate:modelValue":e[3]||(e[3]=o=>l(n).config.url=o),placeholder:"https://example.com/webhook"},null,8,["modelValue"])]),_:1})):U("",!0),l(n).type==="email"?(r(),A(u,{key:1,label:"Email Address",required:""},{default:a(()=>[t(y,{modelValue:l(n).config.to,"onUpdate:modelValue":e[4]||(e[4]=o=>l(n).config.to=o),type:"email",placeholder:"alerts@example.com"},null,8,["modelValue"])]),_:1})):U("",!0),l(n).type==="slack"?(r(),A(u,{key:2,label:"Slack Webhook URL",required:""},{default:a(()=>[t(y,{modelValue:l(n).config.webhook_url,"onUpdate:modelValue":e[5]||(e[5]=o=>l(n).config.webhook_url=o),placeholder:"https://hooks.slack.com/..."},null,8,["modelValue"])]),_:1})):U("",!0),t(u,{label:"Conditions"},{default:a(()=>[s("div",ue,[t(w,{modelValue:l(n).config.conditions.on_new_group,"onUpdate:modelValue":e[6]||(e[6]=o=>l(n).config.conditions.on_new_group=o),label:"Alert on new crash group"},null,8,["modelValue"]),t(w,{modelValue:l(n).config.conditions.on_every_crash,"onUpdate:modelValue":e[7]||(e[7]=o=>l(n).config.conditions.on_every_crash=o),label:"Alert on every crash"},null,8,["modelValue"])])]),_:1}),t(u,null,{default:a(()=>[t(w,{modelValue:l(n).enabled,"onUpdate:modelValue":e[8]||(e[8]=o=>l(n).enabled=o),label:"Enable this alert"},null,8,["modelValue"])]),_:1})])]),_:1})]),_:1},8,["modelValue"])])}}});export{Ae as default};
