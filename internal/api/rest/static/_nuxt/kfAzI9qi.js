import{_ as F}from"./BAT_9lwm.js";import{_ as L}from"./BibONXFg.js";import{_ as T}from"./11PQt58c.js";import{_ as j}from"./C29POXRi.js";import{u as P,_ as R,a as G}from"./DhQdksfa.js";import{_ as M}from"./lbA662FO.js";import{_ as z}from"./CpvovYk5.js";import{_ as O}from"./Dvcp86dS.js";import{_ as Y}from"./C9xZg1J6.js";import{e as q,f as H,g as J,o as l,c as u,h as a,i as v,w as s,b as o,j as Q,a as t,F as k,k as W,t as r,r as X,d as A,l as N,m as x}from"./C2I5neRf.js";import"./DlAUqK2U.js";import"./DqghtnId.js";const Z={class:"space-y-6"},tt={class:"flex items-center gap-4"},et={key:0,class:"flex items-center justify-center py-12"},st={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ot={class:"flex items-center"},nt={class:"p-3 rounded-lg bg-red-500/10"},at={class:"ml-4"},lt={class:"text-2xl font-bold text-white"},rt={class:"flex items-center"},it={class:"p-3 rounded-lg bg-yellow-500/10"},ct={class:"ml-4"},_t={class:"text-2xl font-bold text-white"},dt={class:"flex items-center"},ut={class:"p-3 rounded-lg bg-blue-500/10"},mt={class:"ml-4"},pt={class:"text-2xl font-bold text-white"},xt={class:"flex items-center"},ft={class:"p-3 rounded-lg bg-green-500/10"},gt={class:"ml-4"},ht={class:"text-2xl font-bold text-white"},yt={class:"flex items-center justify-between"},vt={key:0,class:"text-center py-8 text-gray-500"},wt={key:1,class:"space-y-3"},bt={class:"flex items-start justify-between"},kt={class:"flex-1 min-w-0"},At={class:"flex items-center gap-2"},Ut={class:"text-sm font-medium text-white truncate"},It={class:"mt-1 text-sm text-gray-400 truncate"},Nt={class:"text-right ml-4"},Vt={class:"text-sm font-medium text-white"},Ct={class:"text-xs text-gray-500"},Kt={class:"text-gray-400 truncate max-w-xs block"},zt=q({__name:"index",setup(Bt){const m=P(),c=x(""),_=x(null),w=x([]),g=x(!0),h=x(null),y=x([]),b=async()=>{if(!m.apiKey.value){g.value=!1;return}try{g.value=!0,h.value=null;const i=await m.getApps();if(y.value=i.data||[],y.value.length>0&&!c.value&&(c.value=y.value[0].id),c.value){_.value=await m.getAppStats(c.value);const e=await m.getGroups({app_id:c.value,limit:5,sort_by:"last_seen",sort_order:"desc"});w.value=e.data||[]}}catch(i){h.value=i.message||"Failed to load data"}finally{g.value=!1}};H(c,()=>b()),J(()=>{b()});const p=i=>new Intl.NumberFormat().format(i),V=i=>new Date(i).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),C=i=>{switch(i){case"open":return"red";case"resolved":return"green";case"ignored":return"gray";default:return"gray"}};return(i,e)=>{const K=F,B=L,d=T,D=j,f=R,S=M,$=G,U=z,I=O,E=Y;return l(),u("div",Z,[a(m).apiKey.value?(l(),u(k,{key:1},[t("div",tt,[o(D,{modelValue:a(c),"onUpdate:modelValue":e[1]||(e[1]=n=>W(c)?c.value=n:null),options:a(y),"option-attribute":"name","value-attribute":"id",placeholder:"Select an app",class:"w-64"},null,8,["modelValue","options"])]),a(g)?(l(),u("div",et,[o(f,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-primary-500"})])):a(h)?(l(),v(S,{key:1,color:"red",title:a(h)},null,8,["title"])):a(_)?(l(),u(k,{key:2},[t("div",st,[o(d,null,{default:s(()=>[t("div",ot,[t("div",nt,[o(f,{name:"i-heroicons-bug-ant",class:"w-6 h-6 text-red-500"})]),t("div",at,[e[4]||(e[4]=t("p",{class:"text-sm text-gray-400"},"Total Crashes",-1)),t("p",lt,r(p(a(_).total_crashes)),1)])])]),_:1}),o(d,null,{default:s(()=>[t("div",rt,[t("div",it,[o(f,{name:"i-heroicons-exclamation-triangle",class:"w-6 h-6 text-yellow-500"})]),t("div",ct,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-400"},"Open Issues",-1)),t("p",_t,r(p(a(_).open_groups)),1)])])]),_:1}),o(d,null,{default:s(()=>[t("div",dt,[t("div",ut,[o(f,{name:"i-heroicons-clock",class:"w-6 h-6 text-blue-500"})]),t("div",mt,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-400"},"Last 24h",-1)),t("p",pt,r(p(a(_).crashes_last_24h)),1)])])]),_:1}),o(d,null,{default:s(()=>[t("div",xt,[t("div",ft,[o(f,{name:"i-heroicons-chart-bar",class:"w-6 h-6 text-green-500"})]),t("div",gt,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-400"},"Last 7 Days",-1)),t("p",ht,r(p(a(_).crashes_last_7d)),1)])])]),_:1})]),o(d,null,{header:s(()=>[t("div",yt,[e[9]||(e[9]=t("h3",{class:"text-lg font-semibold"},"Recent Issues",-1)),o(U,{to:"/groups"},{default:s(()=>[o($,{variant:"ghost",size:"sm"},{default:s(()=>[...e[8]||(e[8]=[A("View All",-1)])]),_:1})]),_:1})])]),default:s(()=>[a(w).length===0?(l(),u("div",vt," No crash groups yet ")):(l(),u("div",wt,[(l(!0),u(k,null,X(a(w),n=>(l(),v(U,{key:n.id,to:`/groups/${n.id}`,class:"block p-4 rounded-lg bg-gray-800/50 hover:bg-gray-800 transition-colors"},{default:s(()=>[t("div",bt,[t("div",kt,[t("div",At,[o(I,{color:C(n.status),size:"xs"},{default:s(()=>[A(r(n.status),1)]),_:2},1032,["color"]),t("span",Ut,r(n.error_type),1)]),t("p",It,r(n.error_message),1)]),t("div",Nt,[t("p",Vt,r(p(n.occurrence_count)),1),t("p",Ct,r(V(n.last_seen)),1)])])]),_:2},1032,["to"]))),128))]))]),_:1}),a(_).top_errors?.length?(l(),v(d,{key:0},{header:s(()=>[...e[10]||(e[10]=[t("h3",{class:"text-lg font-semibold"},"Top Errors",-1)])]),default:s(()=>[o(E,{rows:a(_).top_errors,columns:[{key:"error_type",label:"Error Type"},{key:"error_message",label:"Message"},{key:"count",label:"Count"}]},{"error_message-data":s(({row:n})=>[t("span",Kt,r(n.error_message),1)]),"count-data":s(({row:n})=>[o(I,{color:"red"},{default:s(()=>[A(r(p(n.count)),1)]),_:2},1024)]),_:1},8,["rows"])]),_:1})):N("",!0)],64)):N("",!0)],64)):(l(),v(d,{key:0,class:"max-w-md"},{header:s(()=>[...e[2]||(e[2]=[t("h3",{class:"text-lg font-semibold"},"Enter API Key",-1)])]),footer:s(()=>[...e[3]||(e[3]=[t("p",{class:"text-sm text-gray-500"}," You can find your admin API key in the server configuration. ",-1)])]),default:s(()=>[o(B,{label:"Admin API Key"},{default:s(()=>[o(K,{type:"password",placeholder:"Enter your admin API key",onKeyup:e[0]||(e[0]=Q(n=>{a(m).setApiKey(n.target.value),b()},["enter"]))})]),_:1})]),_:1}))])}}});export{zt as default};
