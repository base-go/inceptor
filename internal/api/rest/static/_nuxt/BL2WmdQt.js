import{u as N,a as S,_ as j}from"./DxKJ2GxV.js";import{_ as E}from"./CAYj2atY.js";import{_ as z}from"./Cf-73Gro.js";import{_ as D,a as I}from"./zeiIeqyw.js";import{_ as L}from"./C2IJeqfz.js";import{_ as M}from"./Di-NiOv2.js";import{e as T,g as W,c as a,b as s,w as d,i as P,h as t,m as c,o as i,F as q,r as G,a as l,t as b,d as y,l as w}from"./DEZBpJ03.js";import"./BYvTOXo1.js";import"./DlAUqK2U.js";import"./DqAQajp0.js";const H={class:"space-y-6 max-w-4xl"},J={class:"flex items-center justify-between"},K={key:0,class:"flex items-center justify-center py-8"},O={key:1,class:"space-y-3"},Q={class:"flex items-center gap-4"},X={class:"p-2 rounded-lg bg-gray-700"},Y={class:"flex items-center gap-2"},Z={class:"font-medium capitalize"},ee={class:"text-sm text-gray-400 mt-1"},oe={key:0},te={key:1},le={key:2},ne={key:2,class:"text-center py-8 text-gray-500"},se={class:"space-y-4"},ae={key:0},ie={key:1},re={key:2},de={class:"space-y-2"},ue={class:"flex justify-end gap-2"},we=T({__name:"settings",setup(me){const m=N(),g=c([]),_=c(!0),u=c(!1),n=c({app_id:"",type:"webhook",config:{url:"",conditions:{on_new_group:!0}},enabled:!0}),p=c([]),h=[{label:"Webhook",value:"webhook",icon:"i-heroicons-globe-alt"},{label:"Email",value:"email",icon:"i-heroicons-envelope"},{label:"Slack",value:"slack",icon:"i-simple-icons-slack"}],v=async()=>{if(!m.isAuthenticated.value){_.value=!1;return}try{_.value=!0;const[r,e]=await Promise.all([m.getAlerts(),m.getApps()]);g.value=r.data||[],p.value=e.data||[],p.value.length&&!n.value.app_id&&(n.value.app_id=p.value[0].id)}catch(r){console.error("Failed to load data:",r)}finally{_.value=!1}};W(v);const C=async()=>{try{await m.createAlert(n.value),u.value=!1,n.value={app_id:p.value[0]?.id||"",type:"webhook",config:{url:"",conditions:{on_new_group:!0}},enabled:!0},v()}catch(r){console.error("Failed to create alert:",r)}},R=async r=>{if(confirm("Are you sure you want to delete this alert?"))try{await m.deleteAlert(r),v()}catch(e){console.error("Failed to delete alert:",e)}},$=r=>h.find(e=>e.value===r)?.icon||"i-heroicons-bell";return(r,e)=>{const f=j,x=S,B=E,A=z,U=D,k=L,V=I,F=M;return i(),a("div",H,[s(A,null,{header:d(()=>[l("div",J,[e[12]||(e[12]=l("h3",{class:"text-lg font-semibold"},"Alert Rules",-1)),s(f,{icon:"i-heroicons-plus",size:"sm",onClick:e[0]||(e[0]=o=>u.value=!0)},{default:d(()=>[...e[11]||(e[11]=[y(" Add Alert ",-1)])]),_:1})])]),default:d(()=>[t(_)?(i(),a("div",K,[s(x,{name:"i-heroicons-arrow-path",class:"w-6 h-6 animate-spin text-primary-500"})])):t(g).length?(i(),a("div",O,[(i(!0),a(q,null,G(t(g),o=>(i(),a("div",{key:o.id,class:"flex items-center justify-between p-4 rounded-lg bg-gray-800/50"},[l("div",Q,[l("div",X,[s(x,{name:$(o.type),class:"w-5 h-5"},null,8,["name"])]),l("div",null,[l("div",Y,[l("span",Z,b(o.type),1),s(B,{color:o.enabled?"green":"gray",size:"xs"},{default:d(()=>[y(b(o.enabled?"Active":"Disabled"),1)]),_:2},1032,["color"])]),l("div",ee,[o.type==="webhook"?(i(),a("span",oe,b(o.config.url),1)):o.type==="email"?(i(),a("span",te,b(o.config.to),1)):(i(),a("span",le,"Configured"))])])]),s(f,{icon:"i-heroicons-trash",color:"red",variant:"ghost",onClick:pe=>R(o.id)},null,8,["onClick"])]))),128))])):(i(),a("div",ne,[s(x,{name:"i-heroicons-bell-slash",class:"w-12 h-12 mx-auto mb-4"}),e[13]||(e[13]=l("p",null,"No alerts configured",-1)),e[14]||(e[14]=l("p",{class:"text-sm mt-1"},"Create an alert to get notified of crashes",-1))]))]),_:1}),s(F,{modelValue:t(u),"onUpdate:modelValue":e[10]||(e[10]=o=>P(u)?u.value=o:null)},{default:d(()=>[s(A,null,{header:d(()=>[...e[15]||(e[15]=[l("h3",{class:"text-lg font-semibold"},"Create Alert",-1)])]),footer:d(()=>[l("div",ue,[s(f,{variant:"ghost",onClick:e[9]||(e[9]=o=>u.value=!1)},{default:d(()=>[...e[22]||(e[22]=[y("Cancel",-1)])]),_:1}),s(f,{onClick:C},{default:d(()=>[...e[23]||(e[23]=[y("Create",-1)])]),_:1})])]),default:d(()=>[l("div",se,[l("div",null,[e[16]||(e[16]=l("label",{class:"block text-sm font-medium text-gray-300 mb-1"},"App",-1)),s(U,{modelValue:t(n).app_id,"onUpdate:modelValue":e[1]||(e[1]=o=>t(n).app_id=o),options:t(p),"option-attribute":"name","value-attribute":"id",placeholder:"Select an app"},null,8,["modelValue","options"])]),l("div",null,[e[17]||(e[17]=l("label",{class:"block text-sm font-medium text-gray-300 mb-1"},"Alert Type",-1)),s(U,{modelValue:t(n).type,"onUpdate:modelValue":e[2]||(e[2]=o=>t(n).type=o),options:h,"option-attribute":"label","value-attribute":"value"},null,8,["modelValue"])]),t(n).type==="webhook"?(i(),a("div",ae,[e[18]||(e[18]=l("label",{class:"block text-sm font-medium text-gray-300 mb-1"},"Webhook URL",-1)),s(k,{modelValue:t(n).config.url,"onUpdate:modelValue":e[3]||(e[3]=o=>t(n).config.url=o),placeholder:"https://example.com/webhook"},null,8,["modelValue"])])):w("",!0),t(n).type==="email"?(i(),a("div",ie,[e[19]||(e[19]=l("label",{class:"block text-sm font-medium text-gray-300 mb-1"},"Email Address",-1)),s(k,{modelValue:t(n).config.to,"onUpdate:modelValue":e[4]||(e[4]=o=>t(n).config.to=o),type:"email",placeholder:"alerts@example.com"},null,8,["modelValue"])])):w("",!0),t(n).type==="slack"?(i(),a("div",re,[e[20]||(e[20]=l("label",{class:"block text-sm font-medium text-gray-300 mb-1"},"Slack Webhook URL",-1)),s(k,{modelValue:t(n).config.webhook_url,"onUpdate:modelValue":e[5]||(e[5]=o=>t(n).config.webhook_url=o),placeholder:"https://hooks.slack.com/..."},null,8,["modelValue"])])):w("",!0),l("div",null,[e[21]||(e[21]=l("label",{class:"block text-sm font-medium text-gray-300 mb-1"},"Conditions",-1)),l("div",de,[s(V,{modelValue:t(n).config.conditions.on_new_group,"onUpdate:modelValue":e[6]||(e[6]=o=>t(n).config.conditions.on_new_group=o),label:"Alert on new crash group"},null,8,["modelValue"]),s(V,{modelValue:t(n).config.conditions.on_every_crash,"onUpdate:modelValue":e[7]||(e[7]=o=>t(n).config.conditions.on_every_crash=o),label:"Alert on every crash"},null,8,["modelValue"])])]),l("div",null,[s(V,{modelValue:t(n).enabled,"onUpdate:modelValue":e[8]||(e[8]=o=>t(n).enabled=o),label:"Enable this alert"},null,8,["modelValue"])])])]),_:1})]),_:1},8,["modelValue"])])}}});export{we as default};
