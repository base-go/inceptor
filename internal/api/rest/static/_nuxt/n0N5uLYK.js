import{_ as Q}from"./C2IJeqfz.js";import{_ as W}from"./fk77mUdf.js";import{u as X,_ as Y,a as Z}from"./DxKJ2GxV.js";import{_ as ee}from"./Cf-73Gro.js";import{_ as te}from"./Di-NiOv2.js";import{_ as se}from"./zeiIeqyw.js";import{_ as oe}from"./DqAQajp0.js";import{_ as le}from"./CAYj2atY.js";import{_ as ae}from"./DSq6zDYU.js";import{e as ne,f as re,g as de,o as n,c as g,b as a,w as l,a as t,i as b,h as s,j as z,k as v,l as k,d as C,F,t as i,r as ue,m as r}from"./DEZBpJ03.js";import"./DlAUqK2U.js";import"./BYvTOXo1.js";const ie={class:"space-y-6"},ce={key:0,class:"text-sm text-gray-400 mt-1"},me={class:"space-y-4"},_e={class:"flex justify-end gap-2"},pe={class:"space-y-4"},ge={class:"flex items-center gap-4"},fe={key:0,class:"flex items-center justify-center py-12"},ve={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},xe={class:"flex items-center"},we={class:"p-3 rounded-lg bg-red-500/10"},ye={class:"ml-4"},he={class:"text-2xl font-bold text-white"},be={class:"flex items-center"},ke={class:"p-3 rounded-lg bg-yellow-500/10"},Ce={class:"ml-4"},Ve={class:"text-2xl font-bold text-white"},Pe={class:"flex items-center"},Ue={class:"p-3 rounded-lg bg-blue-500/10"},Le={class:"ml-4"},Ne={class:"text-2xl font-bold text-white"},Ae={class:"flex items-center"},Ee={class:"p-3 rounded-lg bg-green-500/10"},De={class:"ml-4"},Ie={class:"text-2xl font-bold text-white"},$e={class:"flex items-center justify-between"},Be={key:0,class:"text-center py-8 text-gray-500"},Se={key:1,class:"space-y-3"},je={class:"flex items-start justify-between"},Fe={class:"flex-1 min-w-0"},Te={class:"flex items-center gap-2"},Me={class:"text-sm font-medium text-white truncate"},Re={class:"mt-1 text-sm text-gray-400 truncate"},Ke={class:"text-right ml-4"},ze={class:"text-sm font-medium text-white"},Ge={class:"text-xs text-gray-500"},Oe={class:"text-gray-400 truncate max-w-xs block"},at=ne({__name:"index",setup(qe){const u=X(),c=r(""),m=r(null),$=r([]),U=r(!0),L=r(null),N=r([]),x=r(""),A=r(null),B=r(!1),f=r(!1),w=r(""),_=r(""),V=r(""),y=r(null),S=r(!1),T=async()=>{if(x.value){B.value=!0,A.value=null;try{await u.login(x.value),x.value="",u.needsPasswordChange.value?f.value=!0:E()}catch(d){A.value=d.data?.error||"Invalid password"}finally{B.value=!1}}},M=async()=>{if(!(!w.value||!_.value)){if(_.value!==V.value){y.value="Passwords do not match";return}if(_.value.length<4){y.value="Password must be at least 4 characters";return}S.value=!0,y.value=null;try{await u.changePassword(w.value,_.value),f.value=!1,w.value="",_.value="",V.value="",E()}catch(d){y.value=d.data?.error||"Failed to change password"}finally{S.value=!1}}},E=async()=>{if(!u.isAuthenticated.value){U.value=!1;return}try{U.value=!0,L.value=null;const d=await u.getApps();if(N.value=d.data||[],N.value.length>0&&!c.value&&(c.value=N.value[0].id),c.value){m.value=await u.getAppStats(c.value);const e=await u.getGroups({app_id:c.value,limit:5,sort_by:"last_seen",sort_order:"desc"});$.value=e.data||[]}}catch(d){L.value=d.message||"Failed to load data"}finally{U.value=!1}};re(c,()=>E()),de(()=>{u.needsPasswordChange.value&&(f.value=!0),E()});const h=d=>new Intl.NumberFormat().format(d),G=d=>new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),O=d=>{switch(d){case"open":return"red";case"resolved":return"green";case"ignored":return"gray";default:return"gray"}};return(d,e)=>{const D=Q,j=W,I=Y,p=ee,q=te,H=se,P=Z,R=oe,K=le,J=ae;return n(),g("div",ie,[a(q,{modelValue:s(f),"onUpdate:modelValue":e[4]||(e[4]=o=>b(f)?f.value=o:null),"prevent-close":s(u).needsPasswordChange.value},{default:l(()=>[a(p,null,{header:l(()=>[e[7]||(e[7]=t("h3",{class:"text-lg font-semibold"},"Change Password",-1)),s(u).needsPasswordChange.value?(n(),g("p",ce," Please change your default password to continue. ")):k("",!0)]),footer:l(()=>[t("div",_e,[s(u).needsPasswordChange.value?k("",!0):(n(),v(I,{key:0,color:"gray",onClick:e[3]||(e[3]=o=>f.value=!1)},{default:l(()=>[...e[11]||(e[11]=[C(" Cancel ",-1)])]),_:1})),a(I,{loading:s(S),onClick:M},{default:l(()=>[...e[12]||(e[12]=[C(" Change Password ",-1)])]),_:1},8,["loading"])])]),default:l(()=>[t("div",me,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-300 mb-1"},"Current Password",-1)),a(D,{modelValue:s(w),"onUpdate:modelValue":e[0]||(e[0]=o=>b(w)?w.value=o:null),type:"password",placeholder:"Enter current password"},null,8,["modelValue"])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-300 mb-1"},"New Password",-1)),a(D,{modelValue:s(_),"onUpdate:modelValue":e[1]||(e[1]=o=>b(_)?_.value=o:null),type:"password",placeholder:"Enter new password (min 4 chars)"},null,8,["modelValue"])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-300 mb-1"},"Confirm Password",-1)),a(D,{modelValue:s(V),"onUpdate:modelValue":e[2]||(e[2]=o=>b(V)?V.value=o:null),type:"password",placeholder:"Confirm new password",onKeyup:z(M,["enter"])},null,8,["modelValue"])]),s(y)?(n(),v(j,{key:0,color:"red",title:s(y)},null,8,["title"])):k("",!0)])]),_:1})]),_:1},8,["modelValue","prevent-close"]),s(u).isAuthenticated.value?(n(),g(F,{key:1},[t("div",ge,[a(H,{modelValue:s(c),"onUpdate:modelValue":e[6]||(e[6]=o=>b(c)?c.value=o:null),options:s(N),"option-attribute":"name","value-attribute":"id",placeholder:"Select an app",class:"w-64"},null,8,["modelValue","options"])]),s(U)?(n(),g("div",fe,[a(P,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-primary-500"})])):s(L)?(n(),v(j,{key:1,color:"red",title:s(L)},null,8,["title"])):s(m)?(n(),g(F,{key:2},[t("div",ve,[a(p,null,{default:l(()=>[t("div",xe,[t("div",we,[a(P,{name:"i-heroicons-bug-ant",class:"w-6 h-6 text-red-500"})]),t("div",ye,[e[17]||(e[17]=t("p",{class:"text-sm text-gray-400"},"Total Crashes",-1)),t("p",he,i(h(s(m).total_crashes)),1)])])]),_:1}),a(p,null,{default:l(()=>[t("div",be,[t("div",ke,[a(P,{name:"i-heroicons-exclamation-triangle",class:"w-6 h-6 text-yellow-500"})]),t("div",Ce,[e[18]||(e[18]=t("p",{class:"text-sm text-gray-400"},"Open Issues",-1)),t("p",Ve,i(h(s(m).open_groups)),1)])])]),_:1}),a(p,null,{default:l(()=>[t("div",Pe,[t("div",Ue,[a(P,{name:"i-heroicons-clock",class:"w-6 h-6 text-blue-500"})]),t("div",Le,[e[19]||(e[19]=t("p",{class:"text-sm text-gray-400"},"Last 24h",-1)),t("p",Ne,i(h(s(m).crashes_last_24h)),1)])])]),_:1}),a(p,null,{default:l(()=>[t("div",Ae,[t("div",Ee,[a(P,{name:"i-heroicons-chart-bar",class:"w-6 h-6 text-green-500"})]),t("div",De,[e[20]||(e[20]=t("p",{class:"text-sm text-gray-400"},"Last 7 Days",-1)),t("p",Ie,i(h(s(m).crashes_last_7d)),1)])])]),_:1})]),a(p,null,{header:l(()=>[t("div",$e,[e[22]||(e[22]=t("h3",{class:"text-lg font-semibold"},"Recent Issues",-1)),a(R,{to:"/groups"},{default:l(()=>[a(I,{variant:"ghost",size:"sm"},{default:l(()=>[...e[21]||(e[21]=[C("View All",-1)])]),_:1})]),_:1})])]),default:l(()=>[s($).length===0?(n(),g("div",Be," No crash groups yet ")):(n(),g("div",Se,[(n(!0),g(F,null,ue(s($),o=>(n(),v(R,{key:o.id,to:`/groups/${o.id}`,class:"block p-4 rounded-lg bg-gray-800/50 hover:bg-gray-800 transition-colors"},{default:l(()=>[t("div",je,[t("div",Fe,[t("div",Te,[a(K,{color:O(o.status),size:"xs"},{default:l(()=>[C(i(o.status),1)]),_:2},1032,["color"]),t("span",Me,i(o.error_type),1)]),t("p",Re,i(o.error_message),1)]),t("div",Ke,[t("p",ze,i(h(o.occurrence_count)),1),t("p",Ge,i(G(o.last_seen)),1)])])]),_:2},1032,["to"]))),128))]))]),_:1}),s(m).top_errors?.length?(n(),v(p,{key:0},{header:l(()=>[...e[23]||(e[23]=[t("h3",{class:"text-lg font-semibold"},"Top Errors",-1)])]),default:l(()=>[a(J,{rows:s(m).top_errors,columns:[{key:"error_type",label:"Error Type"},{key:"error_message",label:"Message"},{key:"count",label:"Count"}]},{"error_message-data":l(({row:o})=>[t("span",Oe,i(o.error_message),1)]),"count-data":l(({row:o})=>[a(K,{color:"red"},{default:l(()=>[C(i(h(o.count)),1)]),_:2},1024)]),_:1},8,["rows"])]),_:1})):k("",!0)],64)):k("",!0)],64)):(n(),v(p,{key:0,class:"max-w-md"},{header:l(()=>[...e[13]||(e[13]=[t("h3",{class:"text-lg font-semibold"},"Login",-1)])]),footer:l(()=>[...e[16]||(e[16]=[t("p",{class:"text-sm text-gray-500"}," Default password: inceptor ",-1)])]),default:l(()=>[t("div",pe,[t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-300 mb-1"},"Password",-1)),a(D,{modelValue:s(x),"onUpdate:modelValue":e[5]||(e[5]=o=>b(x)?x.value=o:null),type:"password",placeholder:"Enter password",onKeyup:z(T,["enter"])},null,8,["modelValue"])]),s(A)?(n(),v(j,{key:0,color:"red",title:s(A)},null,8,["title"])):k("",!0),a(I,{loading:s(B),block:"",onClick:T},{default:l(()=>[...e[15]||(e[15]=[C(" Login ",-1)])]),_:1},8,["loading"])])]),_:1}))])}}});export{at as default};
